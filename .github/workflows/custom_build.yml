- name: Generate Custom SDK Config
        run: |
          # Handle predefined display configurations
          if [ "${{ github.event.inputs.display_type }}" != "custom" ] && [ "${{ github.event.inputs.display_type }}" != "none" ]; then
            case "${{ github.event.inputs.display_type }}" in
              "MarauderV4_FlipperHub")
                cp "configs/sdkconfig.marauderv4" sdkconfig.defaults || exit 1
                ;;
              "MarauderV6_AwokDual")
                cp "configs/sdkconfig.marauderv6" sdkconfig.defaults || exit 1
                ;;
              "AwokMini")
                cp "configs/sdkconfig.awokmini" sdkconfig.defaults || exit 1
                ;;
              "ESP32-S3-Cardputer")
                cp "configs/sdkconfig.cardputer" sdkconfig.defaults || exit 1
                ;;
              "LillyGoTWatch_S3")
                cp "configs/sdkconfig.S3TWatch" sdkconfig.defaults || exit 1
                ;;
              "CYD2USB")
                cp "configs/sdkconfig.CYD2USB" sdkconfig.defaults || exit 1
                ;;
              "CYDMicroUSB")
                cp "configs/sdkconfig.CYDMicroUSB" sdkconfig.defaults || exit 1
                ;;
              "CYDDualUSB")
                cp "configs/sdkconfig.CYDDualUSB" sdkconfig.defaults || exit 1
                ;;
              "CYD2USB2.4_Inch")
                cp "configs/sdkconfig.CYD2USB2.4Inch" sdkconfig.defaults || exit 1
                ;;
              "Waveshare_LCD")
                cp "configs/sdkconfig.waveshare7inch" sdkconfig.defaults || exit 1
                ;;
              "Crowtech_LCD")
                cp "configs/sdkconfig.crowtech7inch" sdkconfig.defaults || exit 1
                ;;
            esac
          else
            # Start with base config for the selected board
            cp "configs/sdkconfig.default.${{ github.event.inputs.board_type }}" sdkconfig.defaults || exit 1
            
            # Add screen configuration if dimensions are provided and custom display is selected
            if [ "${{ github.event.inputs.display_type }}" == "custom" ]; then
              echo "CONFIG_WITH_SCREEN=y" >> sdkconfig.defaults
              echo "CONFIG_TFT_WIDTH=${{ github.event.inputs.screen_width }}" >> sdkconfig.defaults
              echo "CONFIG_TFT_HEIGHT=${{ github.event.inputs.screen_height }}" >> sdkconfig.defaults
            fi
          fi
          
          # Handle touch support
          if [ "${{ github.event.inputs.use_touch }}" == "true" ] || \
             [ "${{ github.event.inputs.display_type }}" == "ESP32-S3-Cardputer" ] || \
             [ "${{ github.event.inputs.display_type }}" == "LillyGoTWatch_S3" ] || \
             [[ "${{ github.event.inputs.display_type }}" == CYD* ]]; then
            echo "CONFIG_USE_TOUCHSCREEN=y" >> sdkconfig.defaults
          fi

          # Configure flash size
          echo "CONFIG_ESPTOOLPY_FLASHSIZE=\"${{ github.event.inputs.flash_size }}\"" >> sdkconfig.defaults
